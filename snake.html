<html>
	<head>
		<title>Snake</title>
	</head>
	<body>
		<div id="field"></div>
		<script>			
			class Vertex {
				constructor(x, y) {
					this.x = x;
					this.y = y;
					this.el = null;
					this.connections = {};
				}
				connect(key, vertex){
					this.connections[key] = vertex;
				}
				[Symbol.iterator](){
					let needToCheck = [];
					let connections = this.connections;
					for(let key in this.connections) needToCheck.push(key);
					return {
						next(){
							let key = needToCheck.pop();
							while(key !== undefined){
								if(!connections[key].el) return {done: false, value: {key, value: connections[key]}};
								key = needToCheck.pop();
							}
							return {done: true, value: undefined};  // check that iterator works well
						}
					}
				}
			}
			
			class Graph {
				constructor(width, height) {
					this.matrix = new Array(width)
						.fill(0)
						.map((col, x) => new Array(height)
							.fill(0)
							.map((cell, y) => new Vertex(x, y)));
					for(let x = 0; x < width; x++)
						for(let y = 0; y < height; y++) {
							let v = this.matrix[x][y];
							if(y != 0) v.connect('u', this.matrix[x][y - 1]);
							if(x != width - 1) v.connect('r', this.matrix[x + 1][y]);
							if(y != height - 1) v.connect('d', this.matrix[x][y + 1]);
							if(x != 0) v.connect('l', this.matrix[x - 1][y]);
						}
				}
			}
			
			class Controller {
				constructor(obj) {
					if (!obj || !obj.rows || !obj.cols || !obj.wrap) throw new Error();
					this.rows = obj.rows;
					this.cols = obj.cols;
					this.wrap = obj.wrap;
					
					this.graph = new Graph(this.rows, this.cols);
				}
			}
			
			let c = new Controller({
				rows: 10, 
				cols: 10, 
				wrap: document.getElementById('field')
			});
		</script>
		<style>
			td {
				border-right: 1px solid black;
				border-bottom: 1px solid black;
				width:25px;
				height:25px;
			}
			table {
				border-left: 1px solid black;
				border-top: 1px solid black;
			}
		</style>
	</body>
</html>
